<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Evaluación Automática de Créditos Internos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root{
      --brand:#0067c0; --brand-hover:#004d99;
      --text:#1a1a1a; --muted:#4d4d4d;
      --card:#f7f7f7; --border:#dddddd; --radius:10px;
    }
    *{ box-sizing:border-box; }
    body{ margin:0; font-family: Segoe UI, Inter, system-ui, -apple-system, Roboto, Arial, sans-serif; background:#fff; color:var(--text); }

    .hero{ display:flex; min-height:100vh; flex-wrap:wrap; }

    /* IMAGEN IZQUIERDA */
    .hero img{
      width:50%;
      min-width:300px;
      height:auto;
      max-height:100vh;
      object-fit:cover;
      display:block;
      background:#f0f2f5;
    }

    /* CONTENIDO DERECHO */
    .content{
      flex:1; padding:60px 50px; display:flex; flex-direction:column; justify-content:center;
      max-width:760px; margin:0 auto;
    }
    h1{ font-size:clamp(26px,4vw,36px); margin:0 0 10px 0; font-weight:700; letter-spacing:.2px; }
    p.instructions{ font-size:15px; color:var(--muted); margin:6px 0 22px 0; max-width:560px; line-height:1.55; }
    label{ display:block; font-size:14px; margin-bottom:6px; color:#444; }
    textarea{
      width:100%; padding:14px; font-size:15px; border-radius:var(--radius); border:1px solid #ccc;
      resize:vertical; min-height:110px; margin-bottom:14px; background:#fff; color:#111827;
    }
    textarea::placeholder{ color:#8a8a8a; }
    .buttons{ display:flex; gap:10px; margin-bottom:20px; flex-wrap:wrap; }
    button{
      background:var(--brand); color:#fff; border:none; padding:12px 20px; font-size:15px; border-radius:8px; cursor:pointer; transition:background .2s;
    }
    button:hover{ background:var(--brand-hover); }
    .secondary{ background:#e5e5e5; color:#333; }
    .secondary:hover{ background:#d8d8d8; }
    .result-box{ background:var(--card); border:1px solid var(--border); border-radius:var(--radius); padding:18px; white-space:pre-wrap; min-height:120px; }
    .result-title{ font-weight:600; margin-bottom:6px; color:#0f172a; font-size:15px; }

    @media (max-width:900px){
      .hero img{ width:100%; max-height:38vh; }
      .content{ padding:28px 18px 40px 18px; }
    }
  </style>
</head>

<body>
  <div class="hero">
    <!-- Columna izquierda: IMAGEN -->
    <img src="./imagen.jpg" alt="Imagen del portal de créditos" />

    <!-- Columna derecha: CONTENIDO -->
    <div class="content">
      <h1>Evaluación Automática de Créditos Internos</h1>

      <p class="instructions">
        Ingrese la información de la solicitud de crédito interno. El sistema analizará los datos mediante
        Azure Logic Apps e IA para generar un resultado de evaluación.
      </p>

      <label for="prompt">Detalle de la solicitud</label>
      <textarea id="prompt" placeholder="Describa la solicitud o caso a evaluar…"></textarea>

      <div class="buttons">
        <button type="button" onclick="generarResumen()">Evaluar solicitud</button>
        <button type="button" class="secondary" onclick="limpiar()">Limpiar</button>
      </div>

      <div class="result-box" aria-live="polite">
        <div class="result-title">Resultado de la evaluación</div>
        <div id="resultado">Esperando información...</div>
      </div>
    </div>
  </div>

  <script>
    // URL de tu Logic App
    const LOGIC_APP_URL =
      "https://prod-19.westus2.logic.azure.com:443/workflows/4f1e1db811c345a899bc3d0418ac2a55/triggers/When_an_HTTP_request_is_received/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2FWhen_an_HTTP_request_is_received%2Frun&sv=1.0&sig=-tyzU-z4RrPueyb3sN_zvX2qzibgI8ISQxcCXuXwQAw";

    async function generarResumen() {
      const resultadoEl = document.getElementById("resultado");
      const prompt = document.getElementById("prompt").value.trim();

      if (!prompt) {
        resultadoEl.textContent = "Por favor, ingrese el detalle de la solicitud antes de evaluar.";
        return;
      }

      resultadoEl.textContent = "Procesando solicitud...\n(esto puede tardar unos segundos)";
      try {
        const res = await fetch(LOGIC_APP_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ prompt })
        });

        if (!res.ok) {
          const text = await res.text();
          throw new Error(`HTTP ${res.status}: ${text}`);
        }

        const data = await res.json().catch(() => ({}));
        const salida = data.resumen || data.resultado || data.output || JSON.stringify(data, null, 2) || "(respuesta vacía)";
        resultadoEl.textContent = salida;
      } catch (err) {
        resultadoEl.textContent = "ERROR al procesar la solicitud:\n" + (err?.message || err);
      }
    }

    function limpiar() {
      document.getElementById("prompt").value = "";
      document.getElementById("resultado").textContent = "Esperando información...";
    }
  </script>
</body>
</html>